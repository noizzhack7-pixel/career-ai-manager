$file = "c:\Users\User\Projects\ManagerStyle\src\app\employees\employees.component.html"
$content = [System.IO.File]::ReadAllText($file, [System.Text.Encoding]::UTF8)

# Fix Hebrew text
$replacements = @{
    '×¡×™× ×•×Ÿ ×¢×•×'×"×™×' = 'סינון עובדים'
    '×—×™×¤×•×© ×¢×•×'×"' = 'חיפוש עובד'
    '×¡×™× ×•×Ÿ ×œ×¤×™ ×§×˜×'×•×¨×™×"' = 'סינון לפי קטגוריה'
    '×"×›×œ' = 'הכל'
    '×˜×›× ×•×œ×•×'×™×"' = 'טכנולוגיה'
    '×ž×•×"×™×¢×™×Ÿ' = 'מודיעין'
    '×©×™×•×•×§' = 'שיווק'
    '×ž×˜×"' = 'מטה'
    '×œ×•×'×™×¡×˜×™×§×"' = 'לוגיסטיקה'
    '××"×ž×™× ×™×¡×˜×¨×¦×™×"' = 'אדמיניסטרציה'
    '×©×™×•×š ××¨×'×•× ×™' = 'שיוך ארגוני'
    '××'×£ ×¤×™×ª×•×—' = 'אגף פיתוח'
    '××'×£ ×ª×¤×¢×•×œ' = 'אגף תפעול'
    '××'×£ ×ž×›×™×¨×•×ª' = 'אגף מכירות'
    '××'×£ ×©×™×•×•×§' = 'אגף שיווק'
    '××'×£ ×ž×©××'×™ ×× ×•×©' = 'אגף משאבי אנוש'
    '×¡×™×›×•×Ÿ ×¢×–×™×'×"' = 'סיכון עזיבה'
    '×¡×™×›×•×Ÿ ×'×'×•×"' = 'סיכון גבוה'
    '×¡×™×›×•×Ÿ ×'×™× ×•× ×™' = 'סיכון בינוני'
    '×¡×™×›×•×Ÿ × ×ž×•×š' = 'סיכון נמוך'
    '×¡×˜×˜×™×¡×˜×™×§×•×ª' = 'סטטיסטיקות'
    '×¡×"×› ×¢×•×'×"×™×' = 'סה"כ עובדים'
    '×¢×•×'×"×™× ×¤×¢×™×œ×™×' = 'עובדים פעילים'
    '×'×¡×™×›×•×Ÿ ×œ×¢×–×™×'×"' = 'בסיכון לעזיבה'
}

foreach ($key in $replacements.Keys) {
    $content = $content -replace [regex]::Escape($key), $replacements[$key]
}

[System.IO.File]::WriteAllText($file, $content, (New-Object System.Text.UTF8Encoding($false)))
Write-Host "Fixed Hebrew encoding"
